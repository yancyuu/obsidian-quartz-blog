

## å¸¸ç”¨çš„å†…å»ºæ–¹æ³•

| **å¸¸â½¤ä¸“æœ‰å±æ€§** | **è¯´æ˜**      | **è§¦å‘â½…å¼**                  |
| ---------- | ----------- | ------------------------- |
| __init__   | æ„é€ åˆå§‹åŒ–å‡½æ•°     | åˆ›å»ºå®ä¾‹å,èµ‹å€¼æ—¶ä½¿â½¤, åœ¨   new   å  |
| __new__    | â½£æˆå®ä¾‹æ‰€éœ€å±æ€§    | åˆ›å»ºå®ä¾‹æ—¶                     |
| __class__  | å®ä¾‹æ‰€åœ¨çš„ç±»      | å®ä¾‹.   class               |
| __str__    | å®ä¾‹å­—ç¬¦ä¸²è¡¨ç¤º,å¯è¯»æ€§ | print(ç±»å®ä¾‹),å¦‚æ²¡å®ç°ï¼Œ ä½¿â½¤reprç»“æœ |
| __repr__   | å®ä¾‹å­—ç¬¦ä¸²è¡¨ç¤º,å‡†ç¡®æ€§ | ç±»å®ä¾‹ å›â»‹ æˆ–è€…                 |
print(repr(ç±»å®ä¾‹)) |
| __del__ | ææ„ | delåˆ é™¤å®ä¾‹ |
| __dict__ | å®ä¾‹â¾ƒå®šä¹‰å±æ€§ | vars(å®ä¾‹.   dict   ) |
| __doc__ | ç±»â½‚æ¡£,â¼¦ç±»ä¸ç»§æ‰¿ | help(ç±»æˆ–å®ä¾‹) |
| __getattribute__ | å±æ€§è®¿é—®æ‹¦æˆªå™¨ | è®¿é—®å®ä¾‹å±æ€§æ—¶ |
| __bases__ | ç±»çš„æ‰€æœ‰â½—ç±»æ„æˆå…ƒç´  | ç±»å.   bases |

## **__getattribute__ ä¾‹â¼¦:**

```python
class Itcast(object):
    def __init__(self, subject1):
        self.subject1 = subject1
        self.subject2 = 'cpp'

    # å±æ€§è®¿é—®æ—¶æ‹¦æˆªå™¨ï¼Œæ‰“log
    def __getattribute__(self, obj):
        if obj == 'subject1':
            print('log subject1')
            return 'redirect python'
        else:  # æµ‹è¯•æ—¶æ³¨é‡Šæ‰è¿™2è¡Œï¼Œå°†æ‰¾ä¸åˆ°subject2
            return object.__getattribute__(self, obj)

    def show(self):
        print('this is Itcast')

s = Itcast("python")
print(s.subject1)
print(s.subject2)
```

è¿â¾ç»“æœ:

```python
log subject1

redirect python

cpp
```

## **__getattribute__çš„å‘**

é”™è¯¯å†™æ³•ğŸ‘‡ï¼š

```python
class Person(object):
    def __getattribute__(self, obj):
        print("---test---")
        if obj.startswith("a"):
            return "hahha"
        else:
            return self.test

    def test(self):
        print("heihei")
        return "done"

t = Person()
print(t.a)  # è¿”å›hahha
print(t.b)  # è¿”å›"done" å¹¶æ‰“å° "heihei"
```

#åŸå› æ˜¯ï¼šå½“t.bæ‰§â¾æ—¶ï¼Œä¼šè°ƒâ½¤Personç±»ä¸­å®šä¹‰çš„__getattribute__â½…æ³•ï¼Œä½†æ˜¯åœ¨è¿™ä¸ªâ½…æ³•çš„æ‰§â¾è¿‡ç¨‹ä¸­

#ifæ¡ä»¶ä¸æ»¡â¾œï¼Œæ‰€ä»¥ ç¨‹åºæ‰§â¾elseâ¾¥â¾¯çš„ä»£ç ï¼Œå³return self.test é—®é¢˜å°±åœ¨è¿™ï¼Œå› ä¸ºreturn éœ€è¦æŠŠ

#self.testçš„å€¼è¿”å›ï¼Œé‚£ä¹ˆâ¾¸å…ˆè¦è·å–self.testçš„å€¼ï¼Œå› ä¸ºselfæ­¤æ—¶å°±æ˜¯tè¿™ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥self.testå°±æ˜¯

#t.test æ­¤æ—¶è¦è·å–tè¿™ä¸ªå¯¹è±¡çš„testå±æ€§ï¼Œé‚£ä¹ˆå°±ä¼šè·³è½¬åˆ°__getattribute__â½…æ³•å»æ‰§â¾ï¼Œå³æ­¤æ—¶äº§

#â½£äº†é€’å½’è°ƒâ½¤ï¼Œç”±äºè¿™ä¸ªé€’å½’è¿‡ç¨‹ä¸­ æ²¡æœ‰åˆ¤æ–­ä»€ä¹ˆæ—¶å€™æ¨å‡ºï¼Œæ‰€ä»¥è¿™ä¸ªç¨‹åºä¼šæ°¸â½†ä¼‘â½Œçš„è¿â¾ä¸‹å»ï¼Œâ¼œå› ä¸ºæ¯æ¬¡è°ƒâ½¤å‡½æ•°ï¼Œå°±éœ€è¦ä¿å­˜â¼€äº›æ•°æ®ï¼Œé‚£ä¹ˆéšç€è°ƒâ½¤çš„æ¬¡æ•°è¶Šæ¥è¶Šå¤šï¼Œæœ€ç»ˆå†…å­˜åƒå…‰ï¼Œæ‰€ä»¥ç¨‹åº å´©æºƒ

æ­£ç¡®å†™æ³•ğŸ‘‡ï¼š

```python
class Person(object):
    def __getattribute__(self, obj):
        print("---test---")
        if obj.startswith("a"):
            return "hahha"
        else:
            return object.__getattribute__(self, "test")()

    def test(self):
        print("heihei")
        return "done"

t = Person()
print(t.a)  # è¿”å›hahha
print(t.b)  # è¿”å›"done" å¹¶æ‰“å° "heihei"
```

# æ³¨æ„ï¼š**ä»¥åä¸è¦åœ¨__getattribute__â½…æ³•ä¸­è°ƒâ½¤self.xxxx**

## å†…å»ºæ–¹æ³•ï¼šrangeï¼Œmapï¼Œfilter