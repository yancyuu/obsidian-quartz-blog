# OAuth2 授权码模式为什么不直接返回access_token

Owner: yancy yu

OAuth2.0 的授权码（Authorization Code）模式多了一个步骤，即先返回一个授权码，然后用这个授权码去换取 `access_token`。这看似多此一举，实则有几个重要的安全和功能性考虑：

1. **分离前后端**: 在许多应用中，前端和后端可能运行在不同的服务器或域上。授权码模式允许后端安全地储存 `client_secret`，并且只在后端与授权服务器通信以获取 `access_token`。这样，敏感信息不会暴露在前端。
2. **减少攻击面**: 如果直接返回 `access_token`，那么在浏览器重定向过程中，`access_token` 可能会被第三方捕获。而通过授权码的方式，即使第三方截获了授权码，由于没有 `client_secret`，也不能获取到 `access_token`。
3. **灵活性**: 授权码模式允许应用在接收授权码后执行一些额外的步骤，比如内部状态的检查、额外的身份验证等，然后再去换取 `access_token`。
4. **更多的控制权限**: 服务提供商可以通过观察授权码的使用情况来进行更多的安全控制，比如设定授权码的有效期非常短，或者规定授权码只能用一次等。
5. **方便管理**: 授权码可以携带更多的信息和参数，方便开发者和服务提供商管理。

因为以上几点，OAuth 2.0 授权码模式通常被认为是最安全和最灵活的一种授权方式，尤其适用于需要保护 `client_secret` 和需要后端参与的场景。